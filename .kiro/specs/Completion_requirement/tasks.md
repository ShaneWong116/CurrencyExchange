# 实施计划

- [ ] 1. 更新主页组件，移除历史和统计功能
  - 修改 HomePage.vue 组件，移除交易历史和今日统计相关的UI元素和逻辑
  - 简化主页布局，仅保留"交易录入"和"草稿箱"两个主要入口按钮
  - 更新主页的路由导航逻辑
  - _需求: 1.1, 1.2, 1.3_

- [ ] 2. 重构交易录入页面为交易类型选择页面
  - 修改 TransactionPage.vue 组件，将其改为交易类型选择页面
  - 实现三个交易类型按钮：入账、出账、即时买断
  - 添加每个交易类型的图标和描述
  - 实现点击后导航到对应的交易录入表单页面
  - _需求: 2.1, 3.1, 4.1_

- [ ] 3. 创建统一的交易录入表单组件
  - 创建新的 TransactionEntryPage.vue 页面组件
  - 实现基础表单字段：人民币金额、港币金额、汇率、支付渠道、备注
  - 添加图片上传功能支持
  - 实现底部操作按钮：存为草稿、提交录入
  - _需求: 2.2, 2.3, 2.4, 2.5, 3.2, 3.3, 3.4, 3.5_

- [ ] 4. 实现交易类型特定逻辑
  - 在 TransactionEntryPage.vue 中添加交易类型判断逻辑
  - 为即时买断类型添加"即时买断汇率"字段
  - 实现汇率自动计算功能（人民币金额/港币金额）
  - 添加汇率字段的手动编辑功能
  - _需求: 2.3, 3.3, 4.3, 4.4_

- [ ] 5. 实现即时买断的复杂业务逻辑
  - 在交易store中实现即时买断的双记录生成逻辑
  - 创建入账记录：使用原始人民币金额、港币金额和汇率
  - 创建出账记录：使用相同人民币金额、计算港币金额（人民币/即时汇率）和即时汇率
  - 添加即时买断计算的单元测试
  - _需求: 4.7, 7.3, 7.4, 7.5, 7.6_

- [ ] 6. 更新交易状态管理
  - 修改 useTransactionStore 以支持新的交易类型
  - 实现 submitTransaction 方法处理不同交易类型
  - 添加 submitInstantBuyout 方法处理即时买断逻辑
  - 更新交易数据模型接口
  - _需求: 2.6, 2.7, 3.6, 3.7, 4.6_

- [ ] 7. 实现草稿管理功能
  - 更新 useDraftStore 以支持新的交易数据结构
  - 实现草稿保存功能，在点击"存为草稿"时触发
  - 修改 DraftsPage.vue 以显示新的交易类型信息
  - 实现草稿编辑功能，加载草稿数据到交易录入表单
  - 实现草稿删除功能
  - _需求: 2.6, 3.6, 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ] 8. 更新路由配置
  - 修改路由配置以支持新的页面结构
  - 添加 /transaction/entry/:type 路由用于交易录入表单
  - 添加 /drafts/:id/edit 路由用于草稿编辑
  - 实现路由参数传递和处理逻辑
  - _需求: 6.1, 6.2, 6.3, 6.4_

- [ ] 9. 实现页面导航和返回功能
  - 在所有相关页面添加返回按钮
  - 实现返回按钮的导航逻辑
  - 确保从交易录入页面返回到交易类型选择页面
  - 确保从草稿箱页面返回到主页面
  - _需求: 6.1, 6.2, 6.3, 6.4_

- [ ] 10. 添加表单验证和错误处理
  - 实现表单字段验证规则（金额大于0、数字格式等）
  - 添加即时买断汇率验证逻辑
  - 实现网络错误处理和离线提交功能
  - 添加用户友好的错误提示信息
  - _需求: 2.3, 3.3, 4.3, 4.4_

- [ ] 11. 优化移动端用户体验
  - 确保所有新页面和组件的移动端响应式设计
  - 优化触摸交互和按钮大小
  - 实现移动端友好的表单输入体验
  - 测试在不同移动设备上的显示效果
  - _需求: 1.3, 2.1, 3.1, 4.1_

- [ ] 12. 编写单元测试
  - 为即时买断计算逻辑编写单元测试
  - 为交易store的新方法编写测试
  - 为草稿store的功能编写测试
  - 为表单验证逻辑编写测试
  - _需求: 4.8, 7.6_